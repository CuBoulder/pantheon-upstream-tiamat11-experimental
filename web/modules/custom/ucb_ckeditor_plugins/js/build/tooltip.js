!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.tooltip=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/utils.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/utils.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function i(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{"use strict";i.d(o,{default:()=>b});var e=i("ckeditor5/src/core.js");function t(e,t,i,o){return o.createRange(s(e,t,i,!0,o),s(e,t,i,!1,o))}function s(e,t,i,o,s){let r=e.textNode||(o?e.nodeBefore:e.nodeAfter),n=null;for(;r&&r.getAttribute(t)==i;)n=r,r=o?r.previousSibling:r.nextSibling;return n?s.createPositionAt(n,o?"before":"after"):e}function r(e){return Array.from(e.getItems()).reduce(((e,t)=>t.is("text")||t.is("textProxy")?e+t.data:e),"")}var n=i("ckeditor5/src/utils.js");class l extends e.Command{refresh(){const e=this.editor.model,i=e.document.selection,o=i.getFirstRange();if(o.isCollapsed)if(i.hasAttribute("tooltip")){const o=i.getAttribute("ucb-tooltip"),s=t(i.getFirstPosition(),"ucb-tooltip",o,e);this.value={abbr:r(s),title:o,range:s}}else this.value=null;else if(i.hasAttribute("ucb-tooltip")){const s=i.getAttribute("ucb-tooltip");t(i.getFirstPosition(),"ucb-tooltip",s,e).containsRange(o,!0)?this.value={abbr:r(o),title:s,range:o}:this.value=null}else this.value=null;this.isEnabled=e.schema.checkAttributeInSelection(i,"ucb-tooltip")}execute({abbr:e,title:t}){const i=this.editor.model,o=i.document.selection;i.change((s=>{if(o.isCollapsed){if(this.value){const{end:o}=i.insertContent(s.createText(e,{tooltip:t}),this.value.range);s.setSelection(o)}else if(""!==e){const r=o.getFirstPosition(),l=(0,n.toMap)(o.getAttributes());l.set("ucb-tooltip",t);const{end:c}=i.insertContent(s.createText(e,l),r);s.setSelection(c)}s.removeSelectionAttribute("ucb-tooltip")}else{const e=i.schema.getValidRanges(o.getRanges(),"ucb-tooltip");for(const i of e)s.setAttribute("ucb-tooltip",t,i)}}))}}class c extends e.Plugin{init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("addTooltip",new l(this.editor))}_defineSchema(){const e=this.editor.model.schema;e.register("ucb-tooltip",{isContent:!0}),e.extend("$text",{allowAttributes:["ucb-tooltip"]})}_defineConverters(){const e=this.editor.conversion;e.for("downcast").attributeToElement({model:"ucb-tooltip",view:(e,t)=>{const{writer:i}=t;return i.createAttributeElement("abbr",{title:e,class:"ucb-tooltip"})}}),e.for("upcast").elementToAttribute({view:{name:"abbr",attributes:["title"],classes:"ucb-tooltip"},model:{key:"ucb-tooltip",value:e=>e.getAttribute("title")}})}}var a=i("ckeditor5/src/ui.js");class u extends a.View{constructor(t){super(t),this.focusTracker=new n.FocusTracker,this.keystrokes=new n.KeystrokeHandler,this.abbrInputView=this._createInput("Add Tooltip"),this.titleInputView=this._createInput("Add Text"),this.saveButtonView=this._createButton("Save",e.icons.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Cancel",e.icons.cancel,"ck-button-cancel"),this.cancelButtonView.delegate("execute").to(this,"cancel"),this.childViews=this.createCollection([this.abbrInputView,this.titleInputView,this.saveButtonView,this.cancelButtonView]),this._focusCycler=new a.FocusCycler({focusables:this.childViews,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-tooltip-form"],tabindex:"-1"},children:this.childViews})}render(){super.render(),(0,a.submitHandler)({view:this}),this.childViews._items.forEach((e=>{this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.abbrInputView.isEnabled?this.abbrInputView.focus():this.titleInputView.focus()}_createInput(e){const t=new a.LabeledFieldView(this.locale,a.createLabeledInputText);return t.label=e,t}_createButton(e,t,i){const o=new a.ButtonView;return o.set({label:e,icon:t,tooltip:!0,class:i}),o}}class d extends e.Plugin{static get requires(){return[a.ContextualBalloon]}init(){const e=this.editor;this._balloon=this.editor.plugins.get(a.ContextualBalloon),this.formView=this._createFormView(),e.ui.componentFactory.add("tooltip",(()=>{const e=new a.ButtonView;return e.label="Tooltip",e.icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --\x3e<path d="M448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zm32 352c0 17.6-14.4 32-32 32H293.3l-8.5 6.4L192 460v-76H64c-17.6 0-32-14.4-32-32V64c0-17.6 14.4-32 32-32h384c17.6 0 32 14.4 32 32v288zM128 184c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24 24-10.7 24-24-10.7-24-24-24z"/></svg>',e.tooltip=!0,e.withText=!1,this.listenTo(e,"execute",(()=>{this._showUI()})),e}))}_createFormView(){const e=this.editor,t=new u(e.locale);return this.listenTo(t,"submit",(()=>{const i={abbr:t.abbrInputView.fieldView.element.value,title:t.titleInputView.fieldView.element.value};e.execute("addTooltip",i),this._hideUI()})),this.listenTo(t,"cancel",(()=>{this._hideUI()})),(0,a.clickOutsideHandler)({emitter:t,activator:()=>this._balloon.visibleView===t,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()}),t}_showUI(){const e=this.editor.model.document.selection,t=this.editor.commands.get("addTooltip").value;if(this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.abbrInputView.isEnabled=e.getFirstRange().isCollapsed,t)this.formView.abbrInputView.fieldView.value=t.abbr,this.formView.titleInputView.fieldView.value=t.title;else{const t=r(e.getFirstRange());this.formView.abbrInputView.fieldView.value=t,this.formView.titleInputView.fieldView.value=""}this.formView.focus()}_hideUI(){this.formView.abbrInputView.fieldView.value="",this.formView.titleInputView.fieldView.value="",this.formView.element.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus()}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document;let i=null;return i=()=>e.domConverter.viewRangeToDom(t.selection.getFirstRange()),{target:i}}}class h extends e.Plugin{static get requires(){return[c,d]}}const b={Tooltip:h}})(),o=o.default})()));